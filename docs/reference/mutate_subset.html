<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Propogate a calculation performed on a subset of data to the rest of the data — mutate_subset • pmdplyr</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Propogate a calculation performed on a subset of data to the rest of the data — mutate_subset" />

<meta property="og:description" content="This function performs dplyr::summarize on a .filtered subset of data. Then it applies the result to all observations (or all observations in the group, if applied to grouped data), filling in columns of the data with the summarize results, as though dplyr::mutate had been run." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pmdplyr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pmdplyr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/dplyr_variants.html">pmdplyr: dplyr Variants</a>
    </li>
    <li>
      <a href="../articles/panel_tools.html">pmdplyr: Panel Tools</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/NickCH-K/pmdplyr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Propogate a calculation performed on a subset of data to the rest of the data</h1>
    <small class="dont-index">Source: <a href='https://github.com/NickCH-K/pmdplyr/blob/master/R/major_mutate_variations.R'><code>R/major_mutate_variations.R</code></a></small>
    <div class="hidden name"><code>mutate_subset.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function performs <code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>dplyr::summarize</a></code> on a <code>.filter</code>ed subset of data. Then it applies the result to all observations (or all observations in the group, if applied to grouped data), filling in columns of the data with the summarize results, as though <code><a href='https://dplyr.tidyverse.org/reference/mutate.html'>dplyr::mutate</a></code> had been run.</p>
    
    </div>

    <pre class="usage"><span class='fu'>mutate_subset</span>(<span class='no'>.df</span>, <span class='no'>...</span>, <span class='no'>.filter</span>, <span class='kw'>.group_i</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>.i</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>.t</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>.d</span> <span class='kw'>=</span> <span class='fl'>NA</span>, <span class='kw'>.uniqcheck</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>.setpanel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>.df</th>
      <td><p>Data frame or tibble.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Specification to be passed to <code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>dplyr::summarize()</a></code>.</p></td>
    </tr>
    <tr>
      <th>.filter</th>
      <td><p>Unquoted logical condition for which observations <code><a href='https://dplyr.tidyverse.org/reference/summarise.html'>dplyr::summarize()</a></code> operations are to be run on.</p></td>
    </tr>
    <tr>
      <th>.group_i</th>
      <td><p>By default, if <code>.i</code> is specified or found in the data, <code>mutate_cascade</code> will group the data by <code>.i</code>, overwriting any grouping already implemented. Set <code>.group_i = FALSE</code> to avoid this.</p></td>
    </tr>
    <tr>
      <th>.i</th>
      <td><p>Quoted or unquoted variables that identify the individual cases. Note that setting any one of <code>.i</code>, <code>.t</code>, or <code>.d</code> will override all three already applied to the data, and will return data that is <code><a href='as_pibble.html'>as_pibble()</a></code>d with all three, unless <code>.setpanel=FALSE</code>.</p></td>
    </tr>
    <tr>
      <th>.t</th>
      <td><p>Quoted or unquoted variable indicating the time. <code>pmdplyr</code> accepts two kinds of time variables: numeric variables where a fixed distance <code>.d</code> will take you from one observation to the next, or, if <code>.d=0</code>, any standard variable type with an order. Consider using the <code><a href='time_variable.html'>time_variable()</a></code> function to create the necessary variable if your data uses a <code>Date</code> variable for time.</p></td>
    </tr>
    <tr>
      <th>.d</th>
      <td><p>Number indicating the gap in <code>.t</code> between one period and the next. For example, if <code>.t</code> indicates a single day but data is collected once a week, you might set <code>.d=7</code>. To ignore gap length and assume that "one period ago" is always the most recent prior observation in the data, set <code>.d=0</code>. The default <code>.d = NA</code> here will become <code>.d = 1</code> if either <code>.i</code> or <code>.t</code> are declared.</p></td>
    </tr>
    <tr>
      <th>.uniqcheck</th>
      <td><p>Logical parameter. Set to TRUE to always check whether <code>.i</code> and <code>.t</code> uniquely identify observations in the data. By default this is set to FALSE and the check is only performed once per session, and only if at least one of <code>.i</code>, <code>.t</code>, or <code>.d</code> is set.</p></td>
    </tr>
    <tr>
      <th>.setpanel</th>
      <td><p>Logical parameter. <code>TRUE</code> by default, and so if <code>.i</code>, <code>.t</code>, and/or <code>.d</code> are declared, will return a <code>pibble</code> set in that way.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>One application of this is to partially widen data. For example, if your analysis uses childhood height as a control variable in all years, <code>mutate_subset()</code> could be used to easily generate a <code>height_age10</code> variable from a <code>height</code> variable.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>SPrail</span>)
<span class='co'># In preparation for fitting a choice model for how people choose ticket type,</span>
<span class='co'># I'd like to know the price of a "Promo" ticket for a given route</span>
<span class='co'># So that I can compare each other type of ticket price to that type</span>
<span class='no'>SPrail</span> <span class='kw'>&lt;-</span> <span class='no'>SPrail</span> <span class='kw'>%&gt;%</span>
  <span class='fu'>mutate_subset</span>(
    <span class='kw'>promo_price</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span>(<span class='no'>price</span>, <span class='kw'>na.rm</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>),
    <span class='kw'>.filter</span> <span class='kw'>=</span> <span class='no'>fare</span> <span class='kw'>==</span> <span class='st'>"Promo"</span>,
    <span class='kw'>.i</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='no'>origin</span>, <span class='no'>destination</span>)
  )</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Nick Huntington-Klein, Philip Khor.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


